@model Academy.Domain.ViewModels.Sidebar.UserPanelSidebarViewModel

<div class="dashboard__inner sticky-top">
    <div class="dashboard__nav__title">
        <h6>خوش آمدید...</h6>
    </div>
    <div class="dashboard__nav">
        <ul>
            <li>
                <a class="default-nav" href="#">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                         class="feather feather-home">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                    داشبورد</a>
            </li>
            <li>
                <a asp-area="UserPanel" asp-controller="Ticket" asp-action="List">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                         class="feather feather-book-open">
                        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                        <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
                    </svg>
                    تیکت‌های من</a>
                @if (Model.NewTicketsCount > 0)
                {
                    <span class="dashboard__label">@Model.NewTicketsCount</span>
                }
            </li>
            <li>
                <a asp-area="instructor-announcments.html"
                   asp-controller="Account"
                   asp-action="Logout">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                         class="feather feather-volume-1">
                        <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                        <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                    </svg>
                    خروج از حساب کاربری</a>
            </li>
        </ul>
    </div>
    

</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const currentPath = window.location.pathname.toLowerCase();

        document.querySelectorAll(".dashboard__nav a").forEach(link => {
            const linkPath = new URL(link.href).pathname.toLowerCase();
            
            const extraPatterns = {
                "/account/tickets": ["/account/ticket-detail", "/account/create-ticket"]
            };

            let isMatch =
                currentPath === linkPath ||
                currentPath.startsWith(linkPath + "/");
            
            if (extraPatterns[linkPath]) {
                extraPatterns[linkPath].forEach(p => {
                    if (currentPath.startsWith(p)) isMatch = true;
                });
            }

            if (isMatch) {
                document.querySelectorAll(".dashboard__nav a").forEach(l => l.classList.remove("active"));
                document.querySelectorAll(".dashboard__nav li").forEach(li => li.classList.remove("selected"));

                link.classList.add("active");
                const li = link.closest("li");
                if (li) li.classList.add("selected");
            }
        });
        
        if (!document.querySelector(".dashboard__nav a.active")) {
            const defaultLink = document.querySelector(".dashboard__nav a.default-nav");
            if (defaultLink) {
                defaultLink.classList.add("active");
                const li = defaultLink.closest("li");
                if (li) li.classList.add("selected");
            }
        }
    });

</script>

